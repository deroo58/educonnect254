<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduConnect Admin Panel</title>
    <link rel="stylesheet" href="css/admin.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo-section">
                <h2>EduConnect</h2>
            </div>
            <ul class="menu">
                <li class="active">üè† Dashboard</li>
                <li id="usersTab">üë• Users</li>
                <li id="contentTab">üìö Content</li>
                <li>üì∞ Announcements</li>
                <li>‚öôÔ∏è Settings</li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="topbar">
                <h1>Admin Dashboard</h1>
                <div class="admin-info" id="adminMenuToggle">
                    <img src="../assets/images/default-admin.png" alt="Admin" class="admin-pic">
                    <span id="adminName">Admin</span>
                    <div class="dropdown" id="adminDropdown">
                        <ul>
                            <li id="viewProfileBtn">üë§ View Profile</li>
                            <li id="logoutBtn">üö™ Logout</li>
                        </ul>
                    </div>
                </div>
            </header>

            <!-- Stats Cards -->
            <section class="stats">
                <div class="card">
                    <h3>Total Users</h3>
                    <p id="totalUsers">0</p>
                </div>
                <div class="card">
                    <h3>Total Teachers</h3>
                    <p id="totalTeachers">0</p>
                </div>
                <div class="card">
                    <h3>Total Notes</h3>
                    <p id="totalNotes">0</p>
                </div>
                <div class="card">
                    <h3>Total Assignments</h3>
                    <p id="totalAssignments">0</p>
                </div>
            </section>

            <!-- Charts -->
            <section class="charts">
                <h2>User Growth Overview</h2>
                <canvas id="userGrowthChart"></canvas>
            </section>

            <!-- Activity Table -->
            <section class="activity">
                <h2>Recent Activity</h2>
                <table>
                    <thead>
                        <tr>
                            <th>User</th>
                            <th>Action</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody id="activityTable">
                        <tr>
                            <td colspan="3">Loading data...</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- üìö Content Management Section -->
            <section id="content-section" style="display:none;">
                <h2>üìö Manage Learning Materials</h2>

                <!-- Upload Form -->
                <form id="uploadMaterialForm" class="upload-form">
                    <label>Subject:</label>
                    <select id="subjectSelect" required>
                        <option value="" disabled selected>Select Subject</option>
                        <option value="mathematics">Mathematics</option>
                        <option value="english">English</option>
                        <option value="biology">Biology</option>
                        <option value="chemistry">Chemistry</option>
                        <option value="physics">Physics</option>
                        <option value="history">History</option>
                    </select>

                    <label>Form:</label>
                    <select id="formSelect" required>
                        <option value="" disabled selected>Select Form</option>
                        <option value="form1">Form 1</option>
                        <option value="form2">Form 2</option>
                        <option value="form3">Form 3</option>
                        <option value="form4">Form 4</option>
                    </select>

                    <label>Topic Name:</label>
                    <select id="topicSelect" required>
                        <option value="" disabled selected>Select Topic</option>
                    </select>

                    <label>Upload PDF:</label>
                    <input type="file" id="fileInput" accept="application/pdf,video/*" required>

                    <button type="submit" id="uploadBtn">Upload Material</button>
                </form>

                <!-- Uploaded Materials Table -->
                <h3>Uploaded Materials</h3>
                <table id="materialsTable">
                    <thead>
                        <tr>
                            <th>Subject</th>
                            <th>Form</th>
                            <th>Topic</th>
                            <th>File</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="materialsTableBody"></tbody>
                </table>
            </section>
        </main>
    </div>

    <!-- Admin Auth Guard -->
    <script type="module" src="js/adminAuthGuard.js"></script>

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBwgRzr0A8qR2lzOlLP_B1mCiJ90IS2Nms",
            authDomain: "educonnect-2b680.firebaseapp.com",
            projectId: "educonnect-2b680",
            storageBucket: "educonnect-2b680.appspot.com",
            messagingSenderId: "438989414011",
            appId: "1:438989414011:web:c21fe944e6da56094b0cde",
            measurementId: "G-KW63Z7E1CK"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        window.db = db;
    </script>

    <script src="js/firebaseConfig.js" type="module"></script>
    <script src="js/content.js" type="module"></script>
    <script src="js/admin.js" type="module"></script>
    <script src="js/users.js" type="module"></script>

    <script>
        // Toggle between dashboard and content section
        const dashboardSections = document.querySelectorAll(".stats, .charts, .activity");
        const contentSection = document.getElementById("content-section");
        const contentTab = document.getElementById("contentTab");

        contentTab.addEventListener("click", () => {
            dashboardSections.forEach(sec => sec.style.display = "none");
            contentSection.style.display = "block";
        });
    </script>
</body>

</html>